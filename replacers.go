package main

import (
	"bufio"
	"io"
	"strings"
)

// CopyWithReplace reads from an io.Reader, applies replacements, and writes to an io.Writer
func CopyWithReplace(r io.Reader, w io.Writer, replacer *strings.Replacer) error {
	scanner := bufio.NewScanner(r)
	for scanner.Scan() {
		line := scanner.Text()
		replacedLine := replacer.Replace(line)
		_, err := w.Write([]byte(replacedLine + "\n"))
		if err != nil {
			return err
		}
	}
	if err := scanner.Err(); err != nil {
		return err
	}
	return nil
}

func toUnicode() *strings.Replacer {
	return strings.NewReplacer(
		"{!`}", "¡",
		"{\\pounds}", "£",
		"{\\S}", "§",
		"{\\copyright}", "©",
		"{\\textregistered}", "®",
		"{\\circledR}", "®",
		"{\\texttrademark}", "™",
		"{\\pm}", "±",
		"{\\P}", "¶",
		"{\\cdot}", "·",
		"{?`}", "¿",
		"{\\div}", "÷",
		"{\\times}", "×",
		"{\\o}", "ø",
		"{\\O}", "Ø",
		"{\\`A}", "À",
		"{\\'A}", "Á",
		"{\\^A}", "Â",
		"{\\~A}", "Ã",
		"{\\\"A}", "Ä",
		"{\\AA}", "Å",
		"{\\AE}", "Æ",
		"{\\c{C}}", "Ç",
		"{\\c C}", "Ç",
		"{\\`E}", "È",
		"{\\'E}", "É",
		"{\\^E}", "Ê",
		"{\\\"E}", "Ë",
		"{\\`I}", "Ì",
		"{\\'I}", "Í",
		"{\\^I}", "Î",
		"{\\\"I}", "Ï",
		"{\\~N}", "Ñ",
		"{\\`O}", "Ò",
		"{\\'O}", "Ó",
		"{\\^O}", "Ô",
		"{\\~O}", "Õ",
		"{\\\"O}", "Ö",
		"{\\OE}", "Œ",
		"{\\`U}", "Ù",
		"{\\'U}", "Ú",
		"{\\^U}", "Û",
		"{\\\"U}", "Ü",
		"{\\'Y}", "Ý",
		"{\\\"Y}", "Ÿ",
		"{\\ss}", "ß",
		"{\\`a}", "à",
		"{\\'a}", "á",
		"{\\^a}", "â",
		"{\\~a}", "ã",
		"{\\\"a}", "ä",
		"{\\aa}", "å",
		"{\\ae}", "æ",
		"{\\c{c}}", "ç",
		"{\\c c}", "ç",
		"{\\`e}", "è",
		"{\\'e}", "é",
		"{\\^e}", "ê",
		"{\\\"e}", "ë",
		"{\\`\\i}", "ì",
		"{\\'\\i}", "í",
		"{\\^\\i}", "î",
		"{\\\"\\i}", "ï",
		"{\\~n}", "ñ",
		"{\\`o}", "ò",
		"{\\'o}", "ó",
		"{\\^o}", "ô",
		"{\\~o}", "õ",
		"{\\\"o}", "ö",
		"{\\oe}", "œ",
		"{\\`u}", "ù",
		"{\\'u}", "ú",
		"{\\^u}", "û",
		"{\\\"u}", "ü",
		"{\\'y}", "ý",
		"{\\\"y}", "ÿ",
		"\\`{A}", "À",
		"\\'{A}", "Á",
		"\\^{A}", "Â",
		"\\~{A}", "Ã",
		"\\\"{A}", "Ä",
		"\\k{A}", "Ą",
		"\\AE{}", "Æ",
		"\\AE ", "Æ",
		"\\`{E}", "È",
		"\\'{E}", "É",
		"\\^{E}", "Ê",
		"\\\"{E}", "Ë",
		"\\k{E}", "Ę",
		"\\c{C}", "Ç",
		"\\c C", "Ç",
		"\\`{I}", "Ì",
		"\\'{I}", "Í",
		"\\^{I}", "Î",
		"\\\"{I}", "Ï",
		"\\k{I}", "Į",
		"\\~{N}", "Ñ",
		"\\`{O}", "Ò",
		"\\'{O}", "Ó",
		"\\^{O}", "Ô",
		"\\~{O}", "Õ",
		"\\\"{O}", "Ö",
		"\\H{O}", "Ő",
		"\\OE{}", "Œ",
		"\\OE ", "Œ",
		"\\`{U}", "Ù",
		"\\'{U}", "Ú",
		"\\^{U}", "Û",
		"\\\"{U}", "Ü",
		"\\H{U}", "Ű",
		"\\k{U}", "Ų",
		"\\'{Y}", "Ý",
		"\\\"{Y}", "Ÿ",
		"\\`{a}", "à",
		"\\'{a}", "á",
		"\\^{a}", "â",
		"\\~{a}", "ã",
		"\\\"{a}", "ä",
		"\\k{a}", "ą",
		"\\ae{}", "æ",
		"\\ae ", "æ",
		"\\c{c}", "ç",
		"\\c c", "ç",
		"\\`{e}", "è",
		"\\'{e}", "é",
		"\\^{e}", "ê",
		"\\\"{e}", "ë",
		"\\k{e}", "ę",
		"\\`{\\i}", "ì",
		"\\'{\\i}", "í",
		"\\^{\\i}", "î",
		"\\\"{\\i}", "ï",
		"\\k{i}", "į",
		"\\~{n}", "ñ",
		"\\`{o}", "ò",
		"\\'{o}", "ó",
		"\\^{o}", "ô",
		"\\~{o}", "õ",
		"\\\"{o}", "ö",
		"\\H{o}", "ő",
		"\\oe{}", "œ",
		"\\oe ", "œ",
		"\\`{u}", "ù",
		"\\'{u}", "ú",
		"\\^{u}", "û",
		"\\\"{u}", "ü",
		"\\H{u}", "ű",
		"\\k{u}", "ų",
		"\\'{y}", "ý",
		"\\\"{y}", "ÿ",
		"\\`A", "À",
		"\\'A", "Á",
		"\\^A", "Â",
		"\\~A", "Ã",
		"\\\"A", "Ä",
		"\\`E", "È",
		"\\'E", "É",
		"\\^E", "Ê",
		"\\\"E", "Ë",
		"\\`I", "Ì",
		"\\'I", "Í",
		"\\^I", "Î",
		"\\\"I", "Ï",
		"\\~N", "Ñ",
		"\\`O", "Ò",
		"\\'O", "Ó",
		"\\^O", "Ô",
		"\\~O", "Õ",
		"\\\"O", "Ö",
		"\\`U", "Ù",
		"\\'U", "Ú",
		"\\^U", "Û",
		"\\\"U", "Ü",
		"\\'Y", "Ý",
		"\\\"Y", "Ÿ",
		"\\`a", "à",
		"\\'a", "á",
		"\\^a", "â",
		"\\~a", "ã",
		"\\\"a", "ä",
		"\\`e", "è",
		"\\'e", "é",
		"\\^e", "ê",
		"\\\"e", "ë",
		"\\`\\i", "ì",
		"\\'\\i", "í",
		"\\^\\i", "î",
		"\\\"\\i", "ï",
		"\\~n", "ñ",
		"\\`o", "ò",
		"\\'o", "ó",
		"\\^o", "ô",
		"\\~o", "õ",
		"\\\"o", "ö",
		"\\`u", "ù",
		"\\'u", "ú",
		"\\^u", "û",
		"\\\"u", "ü",
		"\\'y", "ý",
		"\\\"y", "ÿ",
	)
}

func toLatex() *strings.Replacer {
	return strings.NewReplacer(
		"¡", "{!`}",
		"£", "{\\pounds}",
		"§", "{\\S}",
		"©", "{\\copyright}",
		"®", "{\\textregistered}",
		"™", "{\\texttrademark}",
		"±", "{\\pm}",
		"¶", "{\\P}",
		"·", "{\\cdot}",
		"¿", "{?`}",
		"÷", "{\\div}",
		"×", "{\\times}",
		"ø", "{\\o}",
		"Ø", "{\\O}",
		"À", "\\`A",
		"Á", "\\'A",
		"Â", "\\^A",
		"Ã", "\\~A",
		"Ä", "\\\"A",
		"Å", "{\\AA}",
		"Æ", "{\\AE}",
		"Ą", "\\k{A}",
		"Ç", "\\c{C}",
		"È", "\\`E",
		"É", "\\'E",
		"Ê", "\\^E",
		"Ë", "\\\"E",
		"Ę", "\\k{E}",
		"Ì", "\\`I",
		"Í", "\\'I",
		"Î", "\\^I",
		"Ï", "\\\"I",
		"Į", "\\k{I}",
		"Ñ", "\\~N",
		"Ò", "\\`O",
		"Ó", "\\'O",
		"Ô", "\\^O",
		"Õ", "\\~O",
		"Ö", "\\\"O",
		"Ő", "\\H{O}",
		"Œ", "{\\OE}",
		"Ù", "\\`U",
		"Ú", "\\'U",
		"Û", "\\^U",
		"Ü", "\\\"U",
		"Ű", "\\H{U}",
		"Ų", "\\k{U}",
		"Ý", "\\'Y",
		"Ÿ", "\\\"Y",
		"ß", "{\\ss}",
		"à", "\\`a",
		"á", "\\'a",
		"â", "\\^a",
		"ã", "\\~a",
		"ä", "\\\"a",
		"å", "{\\aa}",
		"ą", "\\k{a}",
		"æ", "{\\ae}",
		"ç", "\\c{c}",
		"è", "\\`e",
		"é", "\\'e",
		"ê", "\\^e",
		"ë", "\\\"e",
		"ę", "\\k{e}",
		"ì", "{\\`\\i}",
		"í", "{\\'\\i}",
		"î", "{\\^\\i}",
		"ï", "{\\\"\\i}",
		"į", "\\k{i}",
		"ñ", "\\~n",
		"ò", "\\`o",
		"ó", "\\'o",
		"ô", "\\^o",
		"õ", "\\~o",
		"ö", "\\\"o",
		"ő", "\\H{o}",
		"œ", "{\\oe}",
		"ù", "\\`u",
		"ú", "\\'u",
		"û", "\\^u",
		"ü", "\\\"u",
		"ű", "\\H{u}",
		"ų", "\\k{u}",
		"ý", "\\'y",
		"ÿ", "\\\"y",
	)
}
